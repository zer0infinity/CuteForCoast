#-----------------------------------------------------------------------------------------------------
# Copyright (c) 2005, Peter Sommerlad and IFS Institute for Software at HSR Rapperswil, Switzerland
# All rights reserved.
#
# This library/application is free software; you can redistribute and/or modify it under the terms of
# the license that is included with this library/application in the file license.txt.
#-----------------------------------------------------------------------------------------------------

{
	/DLL {
		CoastLDAP
		CoastActions
	}
	/Modules {
		DataAccessImplsModule
		MappersModule
		ActionsModule
		LDAPConnectionManager
	}

	/LDAPConnectionManager
	{
		/DefMaxConnections 2
	}
	/Actions {
		/CallDataAccessAction	{ CallDA }
		/ConditionalAction	{ Cond }
	}

	/DataAccessImpls {

		/LDAPAbstractDAI {

			/LDAPSearchDAI {
				"LDAPTest_LookupTmpAndEnv"

				"LDAPSearchTest_IllegalQuery"
				"LDAPSearchTest_ScopeBase"
				"LDAPSearchTest_ScopeOneLevel"
				"LDAPSearchTest_ScopeSubTree"
				"LDAPSearchTest_SizeLimit"
				"LDAPSearchTest_AttrSelection"
				LDAPSearchTest_LanguageAttr
				"LDAPSearchTest_AttrsOnly"
				"LDAPSearchTest_Filter"
				"LDAPSearchTest_WrongDN"
				"LDAPSearchTest_EmptyResult"
				"LDAPSearchTest_BinaryValue"

				"LDAPSearchQuery_LookupTkrefactor_NotPooled"
				"LDAPSearchQuery_LookupTkrefactor_Pooled"

				"LDAPConnectionManagerTest_StableQuery"
				"LDAPConnectionManagerTest_Query"
				"LDAPConnectionManagerTest_Query_Added"
			}

			/LDAPDeleteDAI {
				"LDAPDeleteTest_NonLeaf"
				"LDAPDeleteTest_NonExisting"
				"LDAPDeleteTest_ExistingLeaf_NotPooled"
				"LDAPDeleteTest_ExistingLeaf_Pooled"
				"LDAPConnectionManagerTest_Delete"
			}

			/LDAPCompareDAI {
				"LDAPCompareTest_NonExistingEntry"
				"LDAPCompareTest_NonExistingAttribute"
				"LDAPCompareTest_EqualValue"
				"LDAPCompareTest_UnequalValue"
				"LDAPCompareTest_EqualValueBinary"
				LDAPCompareTest_EqualValueBinaryModified
				LDAPCompareTest_EqualValueNonBinaryModified
				"LDAPCompareTest_MissingAttrNameParam"
				"LDAPCompareTest_MissingAttrValueParam"
				"LDAPConnectionManagerTest_Compare"
			}

			/LDAPAddDAI {
				"LDAPAddTest_ExistingEntry"
				"LDAPAddTest_NonExistingEntry_NotPooled"
				"LDAPAddTest_NonExistingEntry_Pooled"
				"LDAPAddTest_MissingRequiredAttributes"
				"LDAPAddTest_NonExistingAttribute"
				"LDAPAddTest_MissingAttrsParam"
				"LDAPAddTest_SingleValues"
				"LDAPConnectionManagerTest_Add"
			}

			/LDAPModifyDAI {
				"LDAPModifyTest_UnknownAttribute"
				"LDAPModifyTest_AddExistingValue"
				"LDAPModifyTest_DeleteRequiredAttribute"
				"LDAPModifyTest_MultipleModify_NotPooled"
				"LDAPModifyTest_MultipleModify_Pooled"
				LDAPModifyTest_ModifyBinaryValue
				"LDAPModifyTest_WrongMods"
				"LDAPModifyTest_EmptyModsGiven"
				"LDAPModifyTest_DeleteNonExistingValue"
				"LDAPModifyTest_DeleteAndAddWholeAttr_NotPooled"
				"LDAPModifyTest_DeleteAndAddWholeAttr_Pooled"
				"LDAPConnectionManagerTest_MultipleModify"
			}
		}
	}

	/Mappers {
		/Input {
			/ParameterMapper {
				"LDAPTest_LookupTmpAndEnv"

				"LDAPSearchTest_IllegalQuery"
				"LDAPSearchTest_ScopeBase"
				"LDAPSearchTest_ScopeOneLevel"
				"LDAPSearchTest_ScopeSubTree"
				"LDAPSearchTest_SizeLimit"
				"LDAPSearchTest_AttrSelection"
				LDAPSearchTest_LanguageAttr
				"LDAPSearchTest_AttrsOnly"
				"LDAPSearchTest_Filter"
				"LDAPSearchTest_WrongDN"
				"LDAPSearchTest_EmptyResult"

				"LDAPSearchQuery_LookupTkrefactor_NotPooled"
				"LDAPSearchQuery_LookupTkrefactor_Pooled"

				"LDAPConnectionManagerTest_StableQuery"
				"LDAPConnectionManagerTest_Query"
				"LDAPConnectionManagerTest_Query_Added"
				"LDAPConnectionManagerTest_Delete"
				"LDAPConnectionManagerTest_Add"
				"LDAPConnectionManagerTest_MultipleModify"
				"LDAPConnectionManagerTest_Compare"

				"LDAPDeleteTest_NonLeaf"
				"LDAPDeleteTest_NonExisting"
				"LDAPDeleteTest_ExistingLeaf_NotPooled"
				"LDAPDeleteTest_ExistingLeaf_Pooled"

				"LDAPCompareTest_NonExistingEntry"
				"LDAPCompareTest_NonExistingAttribute"
				"LDAPCompareTest_EqualValue"
				"LDAPCompareTest_UnequalValue"
				"LDAPCompareTest_EqualValueBinary"
				LDAPCompareTest_EqualValueBinaryModified
				LDAPCompareTest_EqualValueNonBinaryModified
				"LDAPCompareTest_MissingAttrNameParam"
				"LDAPCompareTest_MissingAttrValueParam"

				"LDAPAddTest_ExistingEntry"
				"LDAPAddTest_NonExistingEntry_NotPooled"
				"LDAPAddTest_NonExistingEntry_Pooled"
				"LDAPAddTest_MissingRequiredAttributes"
				"LDAPAddTest_NonExistingAttribute"
				"LDAPAddTest_MissingAttrsParam"
				"LDAPAddTest_SingleValues"

				"LDAPModifyTest_UnknownAttribute"
				"LDAPModifyTest_AddExistingValue"
				"LDAPModifyTest_DeleteRequiredAttribute"
				"LDAPModifyTest_MultipleModify_NotPooled"
				"LDAPModifyTest_MultipleModify_Pooled"
				LDAPModifyTest_ModifyBinaryValue
				"LDAPModifyTest_WrongMods"
				"LDAPModifyTest_EmptyModsGiven"
				"LDAPModifyTest_DeleteNonExistingValue"
				"LDAPModifyTest_DeleteAndAddWholeAttr_NotPooled"
				"LDAPModifyTest_DeleteAndAddWholeAttr_Pooled"
			}
		}
		/Output {
			/RootMapper {
				"LDAPTest_LookupTmpAndEnv"

				"LDAPSearchTest_IllegalQuery"
				"LDAPSearchTest_ScopeBase"
				"LDAPSearchTest_ScopeOneLevel"
				"LDAPSearchTest_ScopeSubTree"
				"LDAPSearchTest_SizeLimit"
				"LDAPSearchTest_AttrSelection"
				LDAPSearchTest_LanguageAttr
				"LDAPSearchTest_AttrsOnly"
				"LDAPSearchTest_Filter"
				"LDAPSearchTest_WrongDN"
				"LDAPSearchTest_EmptyResult"

				"LDAPSearchQuery_LookupTkrefactor_NotPooled"
				"LDAPSearchQuery_LookupTkrefactor_Pooled"

				"LDAPConnectionManagerTest_StableQuery"
				"LDAPConnectionManagerTest_Query"
				"LDAPConnectionManagerTest_Delete"
				"LDAPConnectionManagerTest_Add"
				"LDAPConnectionManagerTest_Query_Added"
				"LDAPConnectionManagerTest_MultipleModify"
				"LDAPConnectionManagerTest_Compare"

				"LDAPDeleteTest_NonLeaf"
				"LDAPDeleteTest_NonExisting"
				"LDAPDeleteTest_ExistingLeaf_NotPooled"
				"LDAPDeleteTest_ExistingLeaf_Pooled"

				"LDAPCompareTest_NonExistingEntry"
				"LDAPCompareTest_NonExistingAttribute"
				"LDAPCompareTest_EqualValue"
				"LDAPCompareTest_UnequalValue"
				"LDAPCompareTest_EqualValueBinary"
				LDAPCompareTest_EqualValueBinaryModified
				LDAPCompareTest_EqualValueNonBinaryModified
				"LDAPCompareTest_MissingAttrNameParam"
				"LDAPCompareTest_MissingAttrValueParam"

				"LDAPAddTest_ExistingEntry"
				"LDAPAddTest_NonExistingEntry_NotPooled"
				"LDAPAddTest_NonExistingEntry_Pooled"
				"LDAPAddTest_MissingRequiredAttributes"
				"LDAPAddTest_NonExistingAttribute"
				"LDAPAddTest_MissingAttrsParam"
				"LDAPAddTest_SingleValues"

				"LDAPModifyTest_UnknownAttribute"
				"LDAPModifyTest_AddExistingValue"
				"LDAPModifyTest_DeleteRequiredAttribute"
				"LDAPModifyTest_MultipleModify_NotPooled"
				"LDAPModifyTest_MultipleModify_Pooled"
				LDAPModifyTest_ModifyBinaryValue
				"LDAPModifyTest_WrongMods"
				"LDAPModifyTest_EmptyModsGiven"
				"LDAPModifyTest_DeleteNonExistingValue"
				"LDAPModifyTest_DeleteAndAddWholeAttr_NotPooled"
				"LDAPModifyTest_DeleteAndAddWholeAttr_Pooled"
			}
		}
	}

######## Test specific section ########

###########################################################################
# 							refactored                                    #
###########################################################################

	# ------------------------------------------------------------
	# LDAP SETTINGS: can be overridden by defining the same
	# slotnames in specific config of a DAImpl (in DAImplMeta.any)
	# ------------------------------------------------------------
	/LDAPConfig_NotPooled
	{
		/LDAPServer		"##LDAPHOST##"
		/LDAPPort		##LDAPPORT##
		/LDAPBindName	"##BINDDN##"
		/LDAPBindPW		"##BINDPW##"
		/LDAPConnectionTimeout	5
		/LDAPTimeout	10
		/LDAPPooledConnections 0
		/LDAPTryAutoRebind		0
	}

	/LDAPConfig_NotPooledBinary
	{
		/LDAPServer		"##LDAPHOST##"
		/LDAPPort		##LDAPPORT##
		/LDAPBindName	"##BINDDN##"
		/LDAPBindPW		"##BINDPW##"
		/LDAPConnectionTimeout	5
		/LDAPTimeout			10
		/LDAPPooledConnections 	0
		/LDAPTryAutoRebind		0
		/PlainBinaryValues		1
	}

	/LDAPConfig_Pooled
	{
		/LDAPServer		"##LDAPHOST##"
		/LDAPPort		##LDAPPORT##
		/LDAPBindName	"##BINDDN##"
		/LDAPBindPW		"##BINDPW##"
		/LDAPConnectionTimeout	5
		/LDAPTimeout	10
		/LDAPPooledConnections 1
		/LDAPTryAutoRebind			1
		/LDAPRebindTimeout 60
	}

	/LDAPConfig_PooledBinary
	{
		/LDAPServer		"##LDAPHOST##"
		/LDAPPort		##LDAPPORT##
		/LDAPBindName	"##BINDDN##"
		/LDAPBindPW		"##BINDPW##"
		/LDAPConnectionTimeout	5
		/LDAPTimeout			10
		/LDAPPooledConnections 	1
		/LDAPTryAutoRebind		1
		/LDAPRebindTimeout 		60
		/PlainBinaryValues		1
	}

	/RunOnly
	{
#		"LDAPTest_LookupTmpAndEnv_NotPooled"
#		"LDAPTest_LookupTmpAndEnv_Pooled"
#		"LDAPSearchTest_IllegalQuery_NotPooled"
#		"LDAPSearchTest_IllegalQuery_Pooled"
#		"LDAPSearchTest_ScopeBase_NotPooled"
#		"LDAPSearchTest_ScopeBase_Pooled"
#		"LDAPSearchTest_ScopeOneLevel_NotPooled"
#		"LDAPSearchTest_ScopeOneLevel_Pooled"
#		"LDAPSearchTest_ScopeSubTree_NotPooled"
#		"LDAPSearchTest_ScopeSubTree_Pooled"
#		"LDAPSearchTest_SizeLimit_NotPooled"
#		"LDAPSearchTest_SizeLimit_Pooled"
#		"LDAPSearchTest_AttrSelection_NotPooled"
#		"LDAPSearchTest_AttrSelection_Pooled"
#		"LDAPSearchTest_AttrsOnly_NotPooled"
#		"LDAPSearchTest_AttrsOnly_Pooled"
#		"LDAPSearchTest_Filter_NotPooled"
#		"LDAPSearchTest_Filter_Pooled"
#		"LDAPSearchTest_WrongDN_NotPooled"
#		"LDAPSearchTest_WrongDN_Pooled"
#		"LDAPSearchTest_EmptyResult_NotPooled"
#		"LDAPSearchTest_EmptyResult_Pooled"
#
#		"LDAPDeleteTest_NonLeaf_NotPooled"
#		"LDAPDeleteTest_NonLeaf_Pooled"
#		"LDAPDeleteTest_NonExisting_NotPooled"
#		"LDAPDeleteTest_NonExisting_Pooled"
#		"LDAPDeleteTest_ExistingLeaf_NotPooled"
#		"LDAPDeleteTest_ExistingLeaf_Pooled"
#
#		"LDAPCompareTest_NonExistingEntry_NotPooled"
#		"LDAPCompareTest_NonExistingEntry_Pooled"
#		"LDAPCompareTest_NonExistingAttribute_NotPooled"
#		"LDAPCompareTest_NonExistingAttribute_Pooled"
#		"LDAPCompareTest_EqualValue_NotPooled"
#		"LDAPCompareTest_EqualValue_Pooled"
#		"LDAPCompareTest_UnequalValue_NotPooled"
#		"LDAPCompareTest_UnequalValue_Pooled"
#		"LDAPCompareTest_MissingAttrNameParam_NotPooled"
#		"LDAPCompareTest_MissingAttrNameParam_Pooled"
#		"LDAPCompareTest_MissingAttrValueParam_NotPooled
#		"LDAPCompareTest_MissingAttrValueParam_Pooled"
#
#		"LDAPAddTest_MissingAttrsParam_NotPooled"
#		"LDAPAddTest_MissingAttrsParam_Pooled_Pooled"
#		"LDAPAddTest_SingleValues_NotPooled"
#		"LDAPAddTest_SingleValues_Pooled"
#		"LDAPAddTest_ExistingEntry_NotPooled"
#		"LDAPAddTest_ExistingEntry_Pooled"
#		"LDAPAddTest_NonExistingEntry_NotPooled
#		"LDAPAddTest_NonExistingEntry_Pooled"
#		"LDAPAddTest_MissingRequiredAttributes_NotPooled"
#		"LDAPAddTest_MissingRequiredAttributes_Pooled"
#		"LDAPAddTest_NonExistingAttribute_NotPooled"
#		"LDAPAddTest_NonExistingAttribute_Pooled"
#
#		"LDAPModifyTest_UnknownAttribute_NotPooled"
#		"LDAPModifyTest_UnknownAttribute_Pooled"
#		"LDAPModifyTest_AddExistingValue_NotPooled"
#		"LDAPModifyTest_AddExistingValue_Pooled"
#		"LDAPModifyTest_DeleteRequiredAttribute_NotPooled"
#		"LDAPModifyTest_DeleteRequiredAttribute_Pooled"
#		"LDAPModifyTest_MultipleModify_NotPooled"
#		"LDAPModifyTest_MultipleModify_Pooled"
#		"LDAPModifyTest_WrongMods_NotPooled"
#		"LDAPModifyTest_WrongMods_Pooled"
#		"LDAPModifyTest_EmptyModsGiven_NotPooled"
#		"LDAPModifyTest_EmptyModsGiven_Pooled"
#		"LDAPModifyTest_DeleteNonExistingValue_NotPooled"
#		"LDAPModifyTest_DeleteNonExistingValue_Pooled"
#		"LDAPModifyTest_DeleteAndAddWholeAttr_NotPooled"
#		"LDAPModifyTest_DeleteAndAddWholeAttr_Pooled"
	}

	/TestCases
	{
		/LDAPTest_LookupTmpAndEnv_NotPooled
		{
			/TmpStore	{
				# connection config
				/LDAPServer		"##LDAPHOST##"
				/LDAPPort		##LDAPPORT##
				/LDAPBindName	"##BINDDN##"
				/LDAPBindPW		"##BINDPW##"
				/LDAPConnectionTimeout	5
				/LDAPTimeout	10
				/LDAPPooledConnections 0
				/LDAPTryAutoRebind		0

				# test config
				/LDAPBase		"ou=tkfu,o=10601,c=CH,dc=##BINDDC##"
				/LDAPScope		"subtree"
			}
			/Env {
				# test config, more parts in different store
				/LDAPSizeLimit	20
			}
			/TheAction
			{
				/CallDA 	LDAPTest_LookupTmpAndEnv
			}
			/ExpectedResult	1
			/Result
			{
				/TmpStore
				{
					/LDAPResult {
						/LDAPTest_LookupTmpAndEnv {
							/NumberOfResultMessages 21
							/NumberOfEntries 20
							/SizeLimitExceeded 1
						}
					}
				}
			}
		}

		/LDAPTest_LookupTmpAndEnv_Pooled
		{
			/TmpStore	{
				# connection config
				/LDAPServer		"##LDAPHOST##"
				/LDAPPort		##LDAPPORT##
				/LDAPBindName	"##BINDDN##"
				/LDAPBindPW		"##BINDPW##"
				/LDAPConnectionTimeout	5
				/LDAPTimeout	10
				/LDAPPooledConnections 1
				/LDAPTryAutoRebind			1
				/LDAPRebindTimeout 60

				# test config
				/LDAPBase		"ou=tkfu,o=10601,c=CH,dc=##BINDDC##"
				/LDAPScope		"subtree"
			}
			/Env {
				# test config, more parts in different store
				/LDAPSizeLimit	20
			}
			/TheAction
			{
				/CallDA 	LDAPTest_LookupTmpAndEnv
			}
			/ExpectedResult	1
			/Result
			{
				/TmpStore
				{
					/LDAPResult {
						/LDAPTest_LookupTmpAndEnv {
							/NumberOfResultMessages 21
							/NumberOfEntries 20
							/SizeLimitExceeded 1
						}
					}
				}
			}
		}

# =============================================================================

		/LDAPSearchTest_IllegalQuery_NotPooled
		{
			/TmpStore	%LDAPConfig_NotPooled
			/TheAction
			{
				/CallDA 	LDAPSearchTest_IllegalQuery
			}
			/ExpectedResult	0
			/Result
			{
				/TmpStore
				{
					/LDAPError {
						/LDAPSearchTest_IllegalQuery {
							/Msg "Illegal Base DN in query (empty or not defined)"
						}
					}
				}
			}
		}

		/LDAPSearchTest_IllegalQuery_Pooled
		{
			/TmpStore	%LDAPConfig_Pooled
			/TheAction
			{
				/CallDA 	LDAPSearchTest_IllegalQuery
			}
			/ExpectedResult	0
			/Result
			{
				/TmpStore
				{
					/LDAPError {
						/LDAPSearchTest_IllegalQuery {
							/Msg "Illegal Base DN in query (empty or not defined)"
						}
					}
				}
			}
		}

# ---------------------------------------------------------------------------
		/LDAPSearchTest_ScopeBase_NotPooled
		{
			/TmpStore	%LDAPConfig_NotPooled
			/TheAction
			{
				/CallDA 	LDAPSearchTest_ScopeBase
			}
			/ExpectedResult	1
			/Result
			{
				/Delim	"^"
				/TmpStore
				{
					/LDAPResult {
						/LDAPSearchTest_ScopeBase {
							/NumberOfResultMessages 2
							/NumberOfEntries 1

							# just check a few expected things (samples)
							/Entries
							{
								/"uid=tkrefactor,ou=tkfu,o=10601,c=CH,dc=##BINDDC##"
								{
									/objectclass {
										"person"
									}
									/uid "tkrefactor"
								}
							}
						}
					}
				}
			}
		}

		/LDAPSearchTest_ScopeBase_Pooled
		{
			/TmpStore	%LDAPConfig_Pooled
			/TheAction
			{
				/CallDA 	LDAPSearchTest_ScopeBase
			}
			/ExpectedResult	1
			/Result
			{
				/Delim	"^"
				/TmpStore
				{
					/LDAPResult {
						/LDAPSearchTest_ScopeBase {
							/NumberOfResultMessages 2
							/NumberOfEntries 1

							# just check a few expected things (samples)
							/Entries
							{
								/"uid=tkrefactor,ou=tkfu,o=10601,c=CH,dc=##BINDDC##"
								{
									/objectclass {
										"person"
									}
									/uid "tkrefactor"
								}
							}
						}
					}
				}
			}
		}

# ---------------------------------------------------------------------------
		/LDAPSearchTest_ScopeOneLevel_NotPooled
		{
			/TmpStore	%LDAPConfig_NotPooled
			/TheAction
			{
				/CallDA 	LDAPSearchTest_ScopeOneLevel
			}
			/ExpectedResult	1
			/Result
			{
				/Delim	"^"
				/TmpStore
				{
					/LDAPResult {
						/LDAPSearchTest_ScopeOneLevel {
							/NumberOfResultMessages 2
							/NumberOfEntries 1
							# check a few expected things within the returned entries
							/Entries
							{
								/"ou=tkfu,o=10601,c=CH,dc=##BINDDC##"
								{
									/objectclass {
										"organizationalUnit"
										"container"
									}
									/name "ifs APPL. User Directory"
								}
							}
						}
					}
				}
			}
		}

		/LDAPSearchTest_ScopeOneLevel_Pooled
		{
			/TmpStore	%LDAPConfig_Pooled
			/TheAction
			{
				/CallDA 	LDAPSearchTest_ScopeOneLevel
			}
			/ExpectedResult	1
			/Result
			{
				/Delim	"^"
				/TmpStore
				{
					/LDAPResult {
						/LDAPSearchTest_ScopeOneLevel {
							/NumberOfResultMessages 2
							/NumberOfEntries 1
							# check a few expected things within the returned entries
							/Entries
							{
								/"ou=tkfu,o=10601,c=CH,dc=##BINDDC##"
								{
									/objectclass {
										"organizationalUnit"
										"container"
									}
									/name "ifs APPL. User Directory"
								}
							}
						}
					}
				}
			}
		}

# ---------------------------------------------------------------------------
		/LDAPSearchTest_ScopeSubTree_NotPooled
		{
			/TmpStore	%LDAPConfig_NotPooled
			/TheAction
			{
				/CallDA 	LDAPSearchTest_ScopeSubTree
			}
			/ExpectedResult	1
			/Result
			{
				/Delim	"^"
				/TmpStore
				{
					/LDAPResult {
						/LDAPSearchTest_ScopeSubTree {
							/NumberOfResultMessages 63
							/NumberOfEntries 62
						}
					}
				}
			}
		}

		/LDAPSearchTest_ScopeSubTree_Pooled
		{
			/TmpStore	%LDAPConfig_Pooled
			/TheAction
			{
				/CallDA 	LDAPSearchTest_ScopeSubTree
			}
			/ExpectedResult	1
			/Result
			{
				/Delim	"^"
				/TmpStore
				{
					/LDAPResult {
						/LDAPSearchTest_ScopeSubTree {
							/NumberOfResultMessages 63
							/NumberOfEntries 62
						}
					}
				}
			}
		}

# ---------------------------------------------------------------------------
		/LDAPSearchTest_SizeLimit_NotPooled
		{
			/TmpStore	%LDAPConfig_NotPooled
			/TheAction
			{
				/CallDA 	LDAPSearchTest_SizeLimit
			}
			/ExpectedResult	1
			/Result
			{
				/Delim	"^"
				/TmpStore
				{
					/LDAPResult {
						/LDAPSearchTest_SizeLimit {
							/NumberOfResultMessages 11
							/NumberOfEntries 10
							/SizeLimitExceeded 1
						}
					}
				}
			}
		}

		/LDAPSearchTest_SizeLimit_Pooled
		{
			/TmpStore	%LDAPConfig_Pooled
			/TheAction
			{
				/CallDA 	LDAPSearchTest_SizeLimit
			}
			/ExpectedResult	1
			/Result
			{
				/Delim	"^"
				/TmpStore
				{
					/LDAPResult {
						/LDAPSearchTest_SizeLimit {
							/NumberOfResultMessages 11
							/NumberOfEntries 10
							/SizeLimitExceeded 1
						}
					}
				}
			}
		}

# ---------------------------------------------------------------------------
		/LDAPSearchTest_AttrSelection_NotPooled
		{
			/TmpStore	%LDAPConfig_NotPooled
			/TheAction
			{
				/CallDA 	LDAPSearchTest_AttrSelection
			}
			/ExpectedResult	1
			/Result
			{
				/Delim	"^"
				/TmpStore
				{
					/LDAPResult {
						/LDAPSearchTest_AttrSelection {
							/NumberOfResultMessages 2
							/NumberOfEntries 1
							# check a few expected things within the returned entries
							/Entries {
								/"uid=tkrefactor,ou=tkfu,o=10601,c=CH,dc=##BINDDC##"
								{
									/pd-dn "cn=CH10601-tkrefactor,dc=tkfpd.hsr.ch"
									/language "D"
								}
							}
						}
					}
				}
			}
		}

		/LDAPSearchTest_AttrSelection_Pooled
		{
			/TmpStore	%LDAPConfig_Pooled
			/TheAction
			{
				/CallDA 	LDAPSearchTest_AttrSelection
			}
			/ExpectedResult	1
			/Result
			{
				/Delim	"^"
				/TmpStore
				{
					/LDAPResult {
						/LDAPSearchTest_AttrSelection {
							/NumberOfResultMessages 2
							/NumberOfEntries 1
							# check a few expected things within the returned entries
							/Entries {
								/"uid=tkrefactor,ou=tkfu,o=10601,c=CH,dc=##BINDDC##"
								{
									/pd-dn "cn=CH10601-tkrefactor,dc=tkfpd.hsr.ch"
									/language "D"
								}
							}
						}
					}
				}
			}
		}

# ---------------------------------------------------------------------------
		/LDAPSearchTest_AttrsOnly_NotPooled
		{
			/TmpStore	%LDAPConfig_NotPooled
			/TheAction
			{
				/CallDA 	LDAPSearchTest_AttrsOnly
			}
			/ExpectedResult	1
			/Result
			{
				/Delim	"^"
				/TmpStore
				{
					/LDAPResult {
						/LDAPSearchTest_AttrsOnly {
							/NumberOfResultMessages 2
							/NumberOfEntries 1
							# check a few expected things within the returned entries
							/Entries
							{
								/"ou=tkfu,o=10601,c=CH,dc=##BINDDC##" {
									"objectclass"
									"ou"
									"name"
									"cn"
									"tkfmodtime"
									"childmodtime"
								}
							}
						}
					}
				}
			}
		}

		/LDAPSearchTest_AttrsOnly_Pooled
		{
			/TmpStore	%LDAPConfig_Pooled
			/TheAction
			{
				/CallDA 	LDAPSearchTest_AttrsOnly
			}
			/ExpectedResult	1
			/Result
			{
				/Delim	"^"
				/TmpStore
				{
					/LDAPResult {
						/LDAPSearchTest_AttrsOnly {
							/NumberOfResultMessages 2
							/NumberOfEntries 1
							# check a few expected things within the returned entries
							/Entries
							{
								/"ou=tkfu,o=10601,c=CH,dc=##BINDDC##" {
									"objectclass"
									"ou"
									"name"
									"cn"
									"tkfmodtime"
									"childmodtime"
								}
							}
						}
					}
				}
			}
		}

# ---------------------------------------------------------------------------
		/LDAPSearchTest_Filter_NotPooled
		{
			/TmpStore	%LDAPConfig_NotPooled
			/TheAction
			{
				/CallDA 	LDAPSearchTest_Filter
			}
			/ExpectedResult	1
			/Result
			{
				/Delim	"^"
				/TmpStore
				{
					/LDAPResult {
						/LDAPSearchTest_Filter {
							/NumberOfResultMessages 2
							/NumberOfEntries 1
							# check a few expected things within the returned entries
							/Entries
							{
							  /"uid=tkrefactor,ou=tkfu,o=10601,c=CH,dc=##BINDDC##"
							  {
								/objectclass {
								  "person"
								  "client"
								  "tkfModify"
								}
								/uid "tkrefactor"
								/language "D"
								/ifs-id "tkrefactor"
							  }
							}
						}
					}
				}
			}
		}

		/LDAPSearchTest_Filter_Pooled
		{
			/TmpStore	%LDAPConfig_Pooled
			/TheAction
			{
				/CallDA 	LDAPSearchTest_Filter
			}
			/ExpectedResult	1
			/Result
			{
				/Delim	"^"
				/TmpStore
				{
					/LDAPResult {
						/LDAPSearchTest_Filter {
							/NumberOfResultMessages 2
							/NumberOfEntries 1
							# check a few expected things within the returned entries
							/Entries
							{
							  /"uid=tkrefactor,ou=tkfu,o=10601,c=CH,dc=##BINDDC##"
							  {
								/objectclass {
								  "person"
								  "client"
								  "tkfModify"
								}
								/uid "tkrefactor"
								/language "D"
								/ifs-id "tkrefactor"
							  }
							}
						}
					}
				}
			}
		}

# ---------------------------------------------------------------------------
		/LDAPSearchTest_WrongDN_NotPooled
		{
			/TmpStore	%LDAPConfig_NotPooled
			/TheAction
			{
				/CallDA 	LDAPSearchTest_WrongDN
			}
			/ExpectedResult	0
			/Result
			{
				/TmpStore
				{
					/LDAPError {
						/LDAPSearchTest_WrongDN {
							/Msg ignore
							/LdapCode 32
							/LdapMsg ignore
						}
					}
				}
			}
		}

		/LDAPSearchTest_WrongDN_Pooled
		{
			/TmpStore	%LDAPConfig_Pooled
			/TheAction
			{
				/CallDA 	LDAPSearchTest_WrongDN
			}
			/ExpectedResult	0
			/Result
			{
				/TmpStore
				{
					/LDAPError {
						/LDAPSearchTest_WrongDN {
							/Msg ignore
							/LdapCode 32
							/LdapMsg ignore
						}
					}
				}
			}
		}

# ---------------------------------------------------------------------------
		/LDAPSearchTest_EmptyResult_NotPooled
		{
			/TmpStore	%LDAPConfig_NotPooled
			/TheAction
			{
				/CallDA 	LDAPSearchTest_EmptyResult
			}
			/ExpectedResult	1
			/Result
			{
				/TmpStore
				{
					/LDAPResult {
						/LDAPSearchTest_EmptyResult {
							/Type "LDAP_RES_SEARCH_RESULT"
							/NumberOfResultMessages 1
							/NumberOfEntries 0
							/Entries *
						}
					}
				}
			}
		}

		/LDAPSearchTest_EmptyResult_Pooled
		{
			/TmpStore	%LDAPConfig_Pooled
			/TheAction
			{
				/CallDA 	LDAPSearchTest_EmptyResult
			}
			/ExpectedResult	1
			/Result
			{
				/TmpStore
				{
					/LDAPResult {
						/LDAPSearchTest_EmptyResult {
							/Type "LDAP_RES_SEARCH_RESULT"
							/NumberOfResultMessages 1
							/NumberOfEntries 0
							/Entries *
						}
					}
				}
			}
		}

# =============================================================================

		/LDAPDeleteTest_NonLeaf_NotPooled
		{
			/TmpStore	%LDAPConfig_NotPooled
			/TheAction
			{
				/CallDA 	LDAPDeleteTest_NonLeaf
			}
			/ExpectedResult	0
			/Result
			{
				/TmpStore
				{
					/LDAPError {
						/LDAPDeleteTest_NonLeaf {
							/Msg ignore
							/LdapCode 66
							/LdapMsg ignore
						}
					}
				}
			}
		}

		/LDAPDeleteTest_NonLeaf_Pooled
		{
			/TmpStore	%LDAPConfig_Pooled
			/TheAction
			{
				/CallDA 	LDAPDeleteTest_NonLeaf
			}
			/ExpectedResult	0
			/Result
			{
				/TmpStore
				{
					/LDAPError {
						/LDAPDeleteTest_NonLeaf {
							/Msg ignore
							/LdapCode 66
							/LdapMsg ignore
						}
					}
				}
			}
		}

# -------------------------------------------------------------------------
		/LDAPDeleteTest_NonExisting_NotPooled
		{
			/TmpStore	%LDAPConfig_NotPooled
			/TheAction
			{
				/CallDA 	LDAPDeleteTest_NonExisting
			}
			/ExpectedResult	0
			/Result
			{
				/TmpStore
				{
					/LDAPError {
						/LDAPDeleteTest_NonExisting {
							/Msg ignore
							/LdapCode 32
							/LdapMsg ignore
						}
					}
				}
			}
		}

		/LDAPDeleteTest_NonExisting_Pooled
		{
			/TmpStore	%LDAPConfig_Pooled
			/TheAction
			{
				/CallDA 	LDAPDeleteTest_NonExisting
			}
			/ExpectedResult	0
			/Result
			{
				/TmpStore
				{
					/LDAPError {
						/LDAPDeleteTest_NonExisting {
							/Msg ignore
							/LdapCode 32
							/LdapMsg ignore
						}
					}
				}
			}
		}

# -------------------------------------------------------------------------
		/LDAPDeleteTest_ExistingLeaf_NotPooled
		{
			/TmpStore	%LDAPConfig_NotPooled
			/TheAction
			{
				/CallDA 	LDAPDeleteTest_ExistingLeaf_NotPooled
			}
			/ExpectedResult	1
			/Result
			{
				/TmpStore
				{
					/LDAPResult {
						/LDAPDeleteTest_ExistingLeaf_NotPooled {
							/Type "LDAP_RES_DELETE"
							/NumberOfResultMessages 1
							/NumberOfEntries 0
							/Entries *
						}
					}
				}
			}
		}

		/LDAPDeleteTest_ExistingLeaf_Pooled
		{
			/TmpStore	%LDAPConfig_Pooled
			/TheAction
			{
				/CallDA 	LDAPDeleteTest_ExistingLeaf_Pooled
			}
			/ExpectedResult	1
			/Result
			{
				/TmpStore
				{
					/LDAPResult {
						/LDAPDeleteTest_ExistingLeaf_Pooled {
							/Type "LDAP_RES_DELETE"
							/NumberOfResultMessages 1
							/NumberOfEntries 0
							/Entries *
						}
					}
				}
			}
		}

# =============================================================================

		/LDAPCompareTest_NonExistingEntry_NotPooled
		{
			/TmpStore	%LDAPConfig_NotPooled
			/TheAction
			{
				/CallDA 	LDAPCompareTest_NonExistingEntry
			}
			/ExpectedResult	0
			/Result
			{
				/TmpStore
				{
					/LDAPError {
						/LDAPCompareTest_NonExistingEntry {
							/Msg ignore
							/LdapCode 32
							/LdapMsg ignore
						}
					}
				}
			}
		}

		/LDAPCompareTest_NonExistingEntry_Pooled
		{
			/TmpStore	%LDAPConfig_Pooled
			/TheAction
			{
				/CallDA 	LDAPCompareTest_NonExistingEntry
			}
			/ExpectedResult	0
			/Result
			{
				/TmpStore
				{
					/LDAPError {
						/LDAPCompareTest_NonExistingEntry {
							/Msg ignore
							/LdapCode 32
							/LdapMsg ignore
						}
					}
				}
			}
		}

# -------------------------------------------------------------------------
		/LDAPCompareTest_NonExistingAttribute_NotPooled
		{
			/TmpStore	%LDAPConfig_NotPooled
			/TheAction
			{
				/CallDA 	LDAPCompareTest_NonExistingAttribute
			}
			/ExpectedResult	0
			/Result
			{
				/TmpStore
				{
					/LDAPError {
						/LDAPCompareTest_NonExistingAttribute {
						    /Msg ignore
							/LdapCode 16
							/LdapMsg ignore
						}
					}
				}
			}
		}
		/LDAPCompareTest_NonExistingAttribute_Pooled
		{
			/TmpStore	%LDAPConfig_Pooled
			/TheAction
			{
				/CallDA 	LDAPCompareTest_NonExistingAttribute
			}
			/ExpectedResult	0
			/Result
			{
				/TmpStore
				{
					/LDAPError {
						/LDAPCompareTest_NonExistingAttribute {
							/Msg ignore
							/LdapCode 16
							/LdapMsg ignore
						}
					}
				}
			}
		}

# -------------------------------------------------------------------------
		/LDAPCompareTest_EqualValue_NotPooled
		{
			/TmpStore	%LDAPConfig_NotPooled
			/TheAction
			{
				/CallDA 	LDAPCompareTest_EqualValue
			}
			/ExpectedResult	1
			/Result
			{
				/TmpStore
				{
					/LDAPResult {
						/LDAPCompareTest_EqualValue {
							/Type "LDAP_RES_COMPARE"
							/Equal 1
							/LdapCode 6
							/LdapMsg ignore
						}
					}
				}
			}
		}
		/LDAPCompareTest_EqualValue_Pooled
		{
			/TmpStore	%LDAPConfig_Pooled
			/TheAction
			{
				/CallDA 	LDAPCompareTest_EqualValue
			}
			/ExpectedResult	1
			/Result
			{
				/TmpStore
				{
					/LDAPResult {
						/LDAPCompareTest_EqualValue {
							/Type "LDAP_RES_COMPARE"
							/Equal 1
							/LdapCode 6
							/LdapMsg ignore
						}
					}
				}
			}
		}

# -------------------------------------------------------------------------
		/LDAPCompareTest_UnequalValue_NotPooled
		{
			/TmpStore	%LDAPConfig_NotPooled
			/TheAction
			{
				/CallDA 	LDAPCompareTest_UnequalValue
			}
			/ExpectedResult	1
			/Result
			{
				/TmpStore
				{
					/LDAPResult {
						/LDAPCompareTest_UnequalValue {
							/Type "LDAP_RES_COMPARE"
							/Equal 0
							/LdapCode 5
							/LdapMsg ignore
						}
					}
				}
			}
		}
		/LDAPCompareTest_UnequalValue_Pooled
		{
			/TmpStore	%LDAPConfig_Pooled
			/TheAction
			{
				/CallDA 	LDAPCompareTest_UnequalValue
			}
			/ExpectedResult	1
			/Result
			{
				/TmpStore
				{
					/LDAPResult {
						/LDAPCompareTest_UnequalValue {
							/Type "LDAP_RES_COMPARE"
							/Equal 0
							/LdapCode 5
							/LdapMsg ignore
						}
					}
				}
			}
		}

# -------------------------------------------------------------------------
		/LDAPCompareTest_EqualValueBinary_NotPooled
		{
			/TmpStore	%LDAPConfig_NotPooled
			/TheAction
			{
				/CallDA 	LDAPCompareTest_EqualValueBinary
			}
			/ExpectedResult	1
			/Result
			{
				/TmpStore
				{
					/LDAPResult {
						/LDAPCompareTest_EqualValueBinary {
							/Type "LDAP_RES_COMPARE"
							/Equal 1
							/LdapCode 6
							/LdapMsg ignore
						}
					}
				}
			}
		}
		/LDAPCompareTest_EqualValueBinary_Pooled
		{
			/TmpStore	%LDAPConfig_Pooled
			/TheAction
			{
				/CallDA 	LDAPCompareTest_EqualValueBinary
			}
			/ExpectedResult	1
			/Result
			{
				/TmpStore
				{
					/LDAPResult {
						/LDAPCompareTest_EqualValueBinary {
							/Type "LDAP_RES_COMPARE"
							/Equal 1
							/LdapCode 6
							/LdapMsg ignore
						}
					}
				}
			}
		}

# -------------------------------------------------------------------------
		/LDAPCompareTest_MissingAttrNameParam_NotPooled
		{
			/TmpStore	%LDAPConfig_NotPooled
			/TheAction
			{
				/CallDA 	LDAPCompareTest_MissingAttrNameParam
			}
			/ExpectedResult	0
			/Result
			{
				/TmpStore
				{
					/LDAPError {
						/LDAPCompareTest_MissingAttrNameParam {
							/Msg "Attribute name not defined (or empty) in compare query"
						}
					}
				}
			}
		}

		/LDAPCompareTest_MissingAttrNameParam_Pooled
		{
			/TmpStore	%LDAPConfig_Pooled
			/TheAction
			{
				/CallDA 	LDAPCompareTest_MissingAttrNameParam
			}
			/ExpectedResult	0
			/Result
			{
				/TmpStore
				{
					/LDAPError {
						/LDAPCompareTest_MissingAttrNameParam {
							/Msg "Attribute name not defined (or empty) in compare query"
						}
					}
				}
			}
		}

# -------------------------------------------------------------------------
		/LDAPCompareTest_MissingAttrValueParam_NotPooled
		{
			/TmpStore	%LDAPConfig_NotPooled
			/TheAction
			{
				/CallDA 	LDAPCompareTest_MissingAttrValueParam
			}
			/ExpectedResult	0
			/Result
			{
				/TmpStore
				{
					/LDAPError {
						/LDAPCompareTest_MissingAttrValueParam {
							/Msg "Value to compare not defined (or empty) in compare query"
						}
					}
				}
			}
		}

		/LDAPCompareTest_MissingAttrValueParam_Pooled
		{
			/TmpStore	%LDAPConfig_Pooled
			/TheAction
			{
				/CallDA 	LDAPCompareTest_MissingAttrValueParam
			}
			/ExpectedResult	0
			/Result
			{
				/TmpStore
				{
					/LDAPError {
						/LDAPCompareTest_MissingAttrValueParam {
							/Msg "Value to compare not defined (or empty) in compare query"
						}
					}
				}
			}
		}

# =============================================================================

		/LDAPAddTest_MissingAttrsParam_NotPooled
		{
			/TmpStore	%LDAPConfig_NotPooled
			/TheAction
			{
				/CallDA 	LDAPAddTest_MissingAttrsParam
			}
			/ExpectedResult	0
			/Result
			{
				/TmpStore
				{
					/LDAPError {
						/LDAPAddTest_MissingAttrsParam {
							/Msg "No attribute type/value pairs defined in add query"
						}
					}
				}
			}
		}
		/LDAPAddTest_MissingAttrsParam_Pooled
		{
			/TmpStore	%LDAPConfig_Pooled
			/TheAction
			{
				/CallDA 	LDAPAddTest_MissingAttrsParam
			}
			/ExpectedResult	0
			/Result
			{
				/TmpStore
				{
					/LDAPError {
						/LDAPAddTest_MissingAttrsParam {
							/Msg "No attribute type/value pairs defined in add query"
						}
					}
				}
			}
		}

# -------------------------------------------------------------------------
		/LDAPAddTest_SingleValues_NotPooled
		{
			/TmpStore	%LDAPConfig_NotPooled
			/TheAction
			{
				/CallDA 	LDAPAddTest_SingleValues
			}
			/ExpectedResult	0
			/Result
			{
				/TmpStore
				{
					/LDAPError {
						/LDAPAddTest_SingleValues {
							/Msg "All values listed under 'Attrs' must have an associated attribute name. Failed at attr: 0"
						}
					}
				}
			}
		}
		/LDAPAddTest_SingleValues_Pooled
		{
			/TmpStore	%LDAPConfig_Pooled
			/TheAction
			{
				/CallDA 	LDAPAddTest_SingleValues
			}
			/ExpectedResult	0
			/Result
			{
				/TmpStore
				{
					/LDAPError {
						/LDAPAddTest_SingleValues {
							/Msg "All values listed under 'Attrs' must have an associated attribute name. Failed at attr: 0"
						}
					}
				}
			}
		}

# -------------------------------------------------------------------------
		/LDAPAddTest_ExistingEntry_NotPooled
		{
			/TmpStore	%LDAPConfig_NotPooled
			/TheAction
			{
				/CallDA 	LDAPAddTest_ExistingEntry
			}
			/ExpectedResult	0
			/Result
			{
				/TmpStore
				{
					/LDAPError {
						/LDAPAddTest_ExistingEntry {
							/Msg ignore
							/LdapCode 68
							/LdapMsg ignore
						}
					}
				}
			}
		}
		/LDAPAddTest_ExistingEntry_Pooled
		{
			/TmpStore	%LDAPConfig_Pooled
			/TheAction
			{
				/CallDA 	LDAPAddTest_ExistingEntry
			}
			/ExpectedResult	0
			/Result
			{
				/TmpStore
				{
					/LDAPError {
						/LDAPAddTest_ExistingEntry {
							/Msg ignore
							/LdapCode 68
							/LdapMsg ignore
						}
					}
				}
			}
		}

# -------------------------------------------------------------------------
		/LDAPAddTest_NonExistingEntry_NotPooled
		{
			/TmpStore	%LDAPConfig_NotPooled
			/TheAction
			{
				/CallDA 	LDAPAddTest_NonExistingEntry_NotPooled
			}
			/ExpectedResult	1
			/Result
			{
				/TmpStore
				{
					/LDAPResult {
						/LDAPAddTest_NonExistingEntry_NotPooled {
							/Type "LDAP_RES_ADD"
							/NumberOfResultMessages 1
							/NumberOfEntries 0
							/Entries *
						}
					}
				}
			}
		}
		/LDAPAddTest_NonExistingEntry_Pooled
		{
			/TmpStore	%LDAPConfig_Pooled
			/TheAction
			{
				/CallDA 	LDAPAddTest_NonExistingEntry_Pooled
			}
			/ExpectedResult	1
			/Result
			{
				/TmpStore
				{
					/LDAPResult {
						/LDAPAddTest_NonExistingEntry_Pooled {
							/Type "LDAP_RES_ADD"
							/NumberOfResultMessages 1
							/NumberOfEntries 0
							/Entries *
						}
					}
				}
			}
		}

# -------------------------------------------------------------------------
		/LDAPAddTest_MissingRequiredAttributes_NotPooled
		{
			/TmpStore	%LDAPConfig_NotPooled
			/TheAction
			{
				/CallDA 	LDAPAddTest_MissingRequiredAttributes
			}
			/ExpectedResult	0
			/Result
			{
				/TmpStore
				{
					/LDAPError {
						/LDAPAddTest_MissingRequiredAttributes {
							/Msg ignore
							/LdapCode 65
							/LdapMsg ignore
						}
					}
				}
			}
		}
		/LDAPAddTest_MissingRequiredAttributes_Pooled
		{
			/TmpStore	%LDAPConfig_Pooled
			/TheAction
			{
				/CallDA 	LDAPAddTest_MissingRequiredAttributes
			}
			/ExpectedResult	0
			/Result
			{
				/TmpStore
				{
					/LDAPError {
						/LDAPAddTest_MissingRequiredAttributes {
							/Msg ignore
							/LdapCode 65
							/LdapMsg ignore
						}
					}
				}
			}
		}

# -------------------------------------------------------------------------
		/LDAPAddTest_NonExistingAttribute_NotPooled
		{
			/TmpStore	%LDAPConfig_NotPooled
			/TheAction
			{
				/CallDA 	LDAPAddTest_NonExistingAttribute
			}
			/ExpectedResult	0
			/Result
			{
				/TmpStore
				{
					/LDAPError {
						/LDAPAddTest_NonExistingAttribute {
							/Msg ignore
							/LdapCode 65
							/LdapMsg ignore
						}
					}
				}
			}
		}

		/LDAPAddTest_NonExistingAttribute_Pooled
		{
			/TmpStore	%LDAPConfig_Pooled
			/TheAction
			{
				/CallDA 	LDAPAddTest_NonExistingAttribute
			}
			/ExpectedResult	0
			/Result
			{
				/TmpStore
				{
					/LDAPError {
						/LDAPAddTest_NonExistingAttribute {
							/Msg ignore
							/LdapCode 65
							/LdapMsg ignore
						}
					}
				}
			}
		}

# =============================================================================

		/LDAPModifyTest_UnknownAttribute_NotPooled
		{
			/TmpStore	%LDAPConfig_NotPooled
			/TheAction
			{
				/CallDA 	LDAPModifyTest_UnknownAttribute
			}
			/ExpectedResult	0
			/Result
			{
				/TmpStore
				{
					/LDAPError {
						/LDAPModifyTest_UnknownAttribute {
							/Msg ignore
							/LdapCode 16
							/LdapMsg ignore
						}
					}
				}
			}
		}
		/LDAPModifyTest_UnknownAttribute_Pooled
		{
			/TmpStore	%LDAPConfig_Pooled
			/TheAction
			{
				/CallDA 	LDAPModifyTest_UnknownAttribute
			}
			/ExpectedResult	0
			/Result
			{
				/TmpStore
				{
					/LDAPError {
						/LDAPModifyTest_UnknownAttribute {
							/Msg ignore
							/LdapCode 16
							/LdapMsg ignore
						}
					}
				}
			}
		}

# -------------------------------------------------------------------------
		/LDAPModifyTest_AddExistingValue_NotPooled
		{
			/TmpStore	%LDAPConfig_NotPooled
			/TheAction
			{
				/CallDA 	LDAPModifyTest_AddExistingValue
			}
			/ExpectedResult	0
			/Result
			{
				/TmpStore
				{
					/LDAPError {
						/LDAPModifyTest_AddExistingValue {
							/Msg ignore
							/LdapCode 20
							/LdapMsg ignore
						}
					}
				}
			}
		}
		/LDAPModifyTest_AddExistingValue_Pooled
		{
			/TmpStore	%LDAPConfig_Pooled
			/TheAction
			{
				/CallDA 	LDAPModifyTest_AddExistingValue
			}
			/ExpectedResult	0
			/Result
			{
				/TmpStore
				{
					/LDAPError {
						/LDAPModifyTest_AddExistingValue {
							/Msg ignore
							/LdapCode 20
							/LdapMsg ignore
						}
					}
				}
			}
		}

# -------------------------------------------------------------------------
		/LDAPModifyTest_DeleteRequiredAttribute_NotPooled
		{
			/TmpStore	%LDAPConfig_NotPooled
			/TheAction
			{
				/CallDA 	LDAPModifyTest_DeleteRequiredAttribute
			}
			/ExpectedResult	0
			/Result
			{
				/TmpStore
				{
					/LDAPError {
						/LDAPModifyTest_DeleteRequiredAttribute {
							/Msg ignore
							/LdapCode 65
							/LdapMsg ignore
						}
					}
				}
			}
		}
		/LDAPModifyTest_DeleteRequiredAttribute_Pooled
		{
			/TmpStore	%LDAPConfig_Pooled
			/TheAction
			{
				/CallDA 	LDAPModifyTest_DeleteRequiredAttribute
			}
			/ExpectedResult	0
			/Result
			{
				/TmpStore
				{
					/LDAPError {
						/LDAPModifyTest_DeleteRequiredAttribute {
							/Msg ignore
							/LdapCode 65
							/LdapMsg ignore
						}
					}
				}
			}
		}

# -------------------------------------------------------------------------
		/LDAPModifyTest_MultipleModify_NotPooled
		{
			/TmpStore	%LDAPConfig_NotPooled
			/TheAction
			{
				/Cond {
					/Call { /CallDA LDAPModifyTest_MultipleModify_NotPooled }
					/True { /CallDA LDAPSearchQuery_LookupTkrefactor_NotPooled }
					# False: do nothing, modification failed
				}
			}
			/ExpectedResult	1
			/Result
			{
				/Delim	"^"
				/TmpStore
				{
					/LDAPResult {
						/LDAPModifyTest_MultipleModify_NotPooled {
							/Type "LDAP_RES_MODIFY"
							/NumberOfResultMessages 1
							/NumberOfEntries 0
							/Entries *
						}
						/LDAPSearchQuery_LookupTkrefactor_NotPooled {
							/Type "LDAP_RES_SEARCH_ENTRY"
							/NumberOfResultMessages 2
							/NumberOfEntries 1

							# only check the stuff we've changed
							/Entries {
							  /uid=tkrefactor,ou=tkfu,o=10601,c=CH,dc=##BINDDC## {
								/tids {
								  "172.016.001.041"
								  "172.016.200.013"
								  "195.112.074.110"
								  "172.016.003.077"
								  "153.046.030.066"
								  "153.046.016.001"
								  "153.046.016.009"
								  "HOST"
								  "230.001.240.000"
								  "555.666.777.888"
								  "111.222.333.444"
								}
								/language "I"
							  }
							}
						}
					}
				}
			}
		}

		/LDAPModifyTest_MultipleModify_Pooled
		{
			/TmpStore	%LDAPConfig_Pooled
			/TheAction
			{
				/Cond {
					/Call { /CallDA LDAPModifyTest_MultipleModify_Pooled }
					/True { /CallDA LDAPSearchQuery_LookupTkrefactor_Pooled }
					# False: do nothing, modification failed
				}
			}
			/ExpectedResult	1
			/Result
			{
				/Delim	"^"
				/TmpStore
				{
					/LDAPResult {
						/LDAPModifyTest_MultipleModify_Pooled {
							/Type "LDAP_RES_MODIFY"
							/NumberOfResultMessages 1
							/NumberOfEntries 0
							/Entries *
						}
						/LDAPSearchQuery_LookupTkrefactor_Pooled {
							/Type "LDAP_RES_SEARCH_ENTRY"
							/NumberOfResultMessages 2
							/NumberOfEntries 1

							# only check the stuff we've changed
							/Entries {
							  /uid=tkrefactor1,ou=tkfu,o=10601,c=CH,dc=##BINDDC## {
								/tids {
								  "172.016.001.041"
								  "172.016.200.013"
								  "195.112.074.110"
								  "172.016.003.077"
								  "153.046.030.066"
								  "153.046.016.001"
								  "153.046.016.009"
								  "HOST"
								  "230.001.240.000"
								  "555.666.777.888"
								  "111.222.333.444"
								}
								/language "I"
							  }
							}
						}
					}
				}
			}
		}
# -------------------------------------------------------------------------
		/LDAPModifyTest_WrongMods_NotPooled
		{
			/TmpStore	%LDAPConfig_NotPooled
			/TheAction
			{
				/CallDA 	LDAPModifyTest_WrongMods
			}
			/ExpectedResult	0
			/Result
			{
				/TmpStore
				{
					/LDAPError {
						/LDAPModifyTest_WrongMods {
							/Msg "No legal modification operations in modify query"
						}
					}
				}
			}
		}
		/LDAPModifyTest_WrongMods_Pooled
		{
			/TmpStore	%LDAPConfig_Pooled
			/TheAction
			{
				/CallDA 	LDAPModifyTest_WrongMods
			}
			/ExpectedResult	0
			/Result
			{
				/TmpStore
				{
					/LDAPError {
						/LDAPModifyTest_WrongMods {
							/Msg "No legal modification operations in modify query"
						}
					}
				}
			}
		}

# -------------------------------------------------------------------------
		/LDAPModifyTest_EmptyModsGiven_NotPooled
		{
			/TmpStore	%LDAPConfig_NotPooled
			/TheAction
			{
				/CallDA 	LDAPModifyTest_EmptyModsGiven
			}
			/ExpectedResult	0
			/Result
			{
				/TmpStore
				{
					/LDAPError {
						/LDAPModifyTest_EmptyModsGiven {
					        /Msg "No modifications defined in modify query"
						}
					}
				}
			}
		}
		/LDAPModifyTest_EmptyModsGiven_Pooled
		{
			/TmpStore	%LDAPConfig_Pooled
			/TheAction
			{
				/CallDA 	LDAPModifyTest_EmptyModsGiven
			}
			/ExpectedResult	0
			/Result
			{
				/TmpStore
				{
					/LDAPError {
						/LDAPModifyTest_EmptyModsGiven {
					        /Msg "No modifications defined in modify query"
						}
					}
				}
			}
		}

# -------------------------------------------------------------------------
		/LDAPModifyTest_DeleteNonExistingValue_NotPooled
		{
			/TmpStore	%LDAPConfig_NotPooled
			/TheAction
			{
				/CallDA 	LDAPModifyTest_DeleteNonExistingValue
			}
			/ExpectedResult	0
			/Result
			{
				/TmpStore
				{
					/LDAPError {
						/LDAPModifyTest_DeleteNonExistingValue {
							/Msg ignore
							/LdapCode 16
							/LdapMsg ignore
						}
					}
				}
			}
		}
		/LDAPModifyTest_DeleteNonExistingValue_Pooled
		{
			/TmpStore	%LDAPConfig_Pooled
			/TheAction
			{
				/CallDA 	LDAPModifyTest_DeleteNonExistingValue
			}
			/ExpectedResult	0
			/Result
			{
				/TmpStore
				{
					/LDAPError {
						/LDAPModifyTest_DeleteNonExistingValue {
							/Msg ignore
							/LdapCode 16
							/LdapMsg ignore
						}
					}
				}
			}
		}

# -------------------------------------------------------------------------
		/LDAPModifyTest_DeleteAndAddWholeAttr_NotPooled
		{
			/TmpStore	%LDAPConfig_NotPooled
			/TheAction
			{
				/Cond {
					/Call { /CallDA LDAPModifyTest_DeleteAndAddWholeAttr_NotPooled }
					/True { /CallDA LDAPSearchQuery_LookupTkrefactor_NotPooled }
					# False: do nothing, modification failed
				}
			}
			/ExpectedResult	1
			/Result
			{
				/Delim "^"
				/IndexDelim "�"
				/TmpStore
				{
					/LDAPResult {
						/LDAPModifyTest_DeleteAndAddWholeAttr_NotPooled {
							/Type "LDAP_RES_MODIFY"
							/NumberOfResultMessages 1
							/NumberOfEntries 0
							/Entries *
						}
						/LDAPSearchQuery_LookupTkrefactor_NotPooled {
						  /Type "LDAP_RES_SEARCH_ENTRY"
						  /NumberOfResultMessages 2
						  /NumberOfEntries 1
						  # only check the relevant fields of the returned entries
						  /Entries {
							/uid=tkrefactor,ou=tkfu,o=10601,c=CH,dc=##BINDDC## {
							  /passwordexp "20010101_00:00:00"
							}
						  }
				        }
					}
				}
			}
		}
		/LDAPModifyTest_DeleteAndAddWholeAttr_Pooled
		{
			/TmpStore	%LDAPConfig_Pooled
			/TheAction
			{
				/Cond {
					/Call { /CallDA LDAPModifyTest_DeleteAndAddWholeAttr_Pooled }
					/True { /CallDA LDAPSearchQuery_LookupTkrefactor_Pooled }
					# False: do nothing, modification failed
				}
			}
			/ExpectedResult	1
			/Result
			{
				/Delim "^"
				/IndexDelim "�"
				/TmpStore
				{
					/LDAPResult {
						/LDAPModifyTest_DeleteAndAddWholeAttr_Pooled {
							/Type "LDAP_RES_MODIFY"
							/NumberOfResultMessages 1
							/NumberOfEntries 0
							/Entries *
						}
						/LDAPSearchQuery_LookupTkrefactor_Pooled {
						  /Type "LDAP_RES_SEARCH_ENTRY"
						  /NumberOfResultMessages 2
						  /NumberOfEntries 1
						  # only check the relevant fields of the returned entries
						  /Entries {
							/uid=tkrefactor1,ou=tkfu,o=10601,c=CH,dc=##BINDDC## {
							  /passwordexp "20010101_00:00:00"
							}
						  }
				        }
					}
				}
			}
		}
		/LDAPModifyTest_ModifyBinaryValue_NonBinaryMode
		{
			/TmpStore	%LDAPConfig_Pooled
			/TheAction
			{
				{ /CallDA 	LDAPModifyTest_ModifyBinaryValue }
				{ /CallDA 	LDAPCompareTest_EqualValueNonBinaryModified }
				{ /CallDA 	LDAPSearchTest_LanguageAttr }
			}
			/ExpectedResult	1
			/Result
			{
				/Delim	"^"
				/TmpStore
				{
					/LDAPResult {
						/LDAPModifyTest_ModifyBinaryValue {
							/Type "LDAP_RES_MODIFY"
							/NumberOfResultMessages 1
							/NumberOfEntries 0
							/Entries *
						}
						/LDAPCompareTest_EqualValueNonBinaryModified {
							/Type "LDAP_RES_COMPARE"
							/Equal 1
							/LdapCode 6
							/LdapMsg ignore
						}
						/LDAPSearchTest_LanguageAttr {
							/NumberOfResultMessages 2
							/NumberOfEntries 1
							# check a few expected things within the returned entries
							/Entries {
								/"uid=tkrefactor2,ou=tkfu,o=10601,c=CH,dc=##BINDDC##"
								{
									/language "This"	## the rest will be cut away when storing...
								}
							}
						}
					}
				}
			}
		}
		/LDAPModifyTest_CompareBinaryValue_NonBinaryMode
		{
			/TmpStore	%LDAPConfig_Pooled
			/TheAction
			{
				{ /CallDA 	LDAPCompareTest_EqualValueBinaryModified }
			}
			/ExpectedResult	1
			/Result
			{
				/TmpStore
				{
					/LDAPResult {
						/LDAPCompareTest_EqualValueBinaryModified {
							/Type "LDAP_RES_COMPARE"
							/Equal 1
							/LdapCode 6
							/LdapMsg ignore
						}
					}
				}
			}
		}
## Unfortunately this test fails due to a potential ldap-library-error
## -> enable as soon as binary comparison is to be supported by lib
#		/LDAPModifyTest_CompareBinaryValue_BinaryMode
#		{
#			/TmpStore	%LDAPConfig_PooledBinary
#			/TheAction
#			{
#				{ /CallDA 	LDAPCompareTest_EqualValueBinaryModified }
#			}
#			/ExpectedResult	1
#			/Result
#			{
#				/TmpStore
#				{
#					/LDAPResult {
#						/LDAPCompareTest_EqualValueBinaryModified {
#							/Type "LDAP_RES_COMPARE"
#							/Equal 0
#							/LdapCode 5
#							/LdapMsg "Compare false"
#						}
#					}
#				}
#			}
#		}
		/LDAPModifyTest_ModifyBinaryValue_BinaryMode
		{
			/TmpStore	%LDAPConfig_PooledBinary
			/TheAction
			{
				{ /CallDA 	LDAPModifyTest_ModifyBinaryValue }
				{ /CallDA 	LDAPCompareTest_EqualValueBinaryModified }
				{ /CallDA 	LDAPSearchTest_LanguageAttr }
			}
			/ExpectedResult	1
			/Result
			{
				/Delim	"^"
				/TmpStore
				{
					/LDAPResult {
						/LDAPModifyTest_ModifyBinaryValue {
							/Type "LDAP_RES_MODIFY"
							/NumberOfResultMessages 1
							/NumberOfEntries 0
							/Entries *
						}
						/LDAPCompareTest_EqualValueBinaryModified {
							/Type "LDAP_RES_COMPARE"
							/Equal 1
							/LdapCode 6
							/LdapMsg ignore
						}
						/LDAPSearchTest_LanguageAttr {
							/NumberOfResultMessages 2
							/NumberOfEntries 1
							# check a few expected things within the returned entries
							/Entries {
								/"uid=tkrefactor2,ou=tkfu,o=10601,c=CH,dc=##BINDDC##"
								{
									/language "This\x00 should have been stored!\x01"
								}
							}
						}
					}
				}
			}
		}
	}
}
